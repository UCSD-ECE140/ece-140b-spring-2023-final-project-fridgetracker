<!DOCTYPE html>
<html>
<head>
  <title>Barcode Scanner</title>
  <style>
    #product-name {
      margin-top: 20px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>Barcode Scanner</h1>
  <button id="scan-button">Scan Barcode</button>
  <p id="product-name"></p>

  <script>
    // Get the scan button element
    const scanButton = document.getElementById('scan-button');

    // Get the product name element
    const productNameElement = document.getElementById('product-name');

    // Add event listener to the scan button
    scanButton.addEventListener('click', () => {
      // Check if the device supports camera access
      if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
        alert('Camera access not supported');
        return;
      }

      // Access the camera
      navigator.mediaDevices.getUserMedia({ video: true })
        .then((stream) => {
          // Create a video element to display the camera stream
          const video = document.createElement('video');
          video.setAttribute('autoplay', '');
          video.setAttribute('playsinline', '');
          video.style.display = 'none';
          document.body.appendChild(video);

          // Create a canvas element to capture the video frame
          const canvas = document.createElement('canvas');
          const context = canvas.getContext('2d');
          canvas.style.display = 'none';
          document.body.appendChild(canvas);

          // Play the video stream in the video element
          video.srcObject = stream;
          video.play();

          // Function to capture video frame and perform barcode scanning
          const captureFrame = () => {
            // Set canvas dimensions equal to the video dimensions
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;

            // Capture the current video frame
            context.drawImage(video, 0, 0, canvas.width, canvas.height);

            // Get the image data from the canvas
            const imageData = context.getImageData(0, 0, canvas.width, canvas.height);

            // TODO: Call the barcode scanning API and pass the imageData

            // Once the API call is successful and you have the product name,
            // update the product name element
            const productName = 'Product Name'; // Replace with the actual product name
            productNameElement.textContent = productName;

            // Stop the video stream and remove the video and canvas elements
            stream.getVideoTracks().forEach(track => track.stop());
            video.remove();
            canvas.remove();
          };

          // Capture the video frame every second
          setInterval(captureFrame, 1000);
        })
        .catch((error) => {
          console.error('Error accessing camera:', error);
        });
    });
  </script>
</body>
</html>
